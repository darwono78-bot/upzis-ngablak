<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Keuangan KOIN NU - Disinkronkan</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }
        th, td { border: 1px solid #333; padding: 8px; text-align: left; }
        th { background-color: #006400; color: white; text-align: center; } /* Warna hijau tua seperti contoh */
        .text-right { text-align: right; }
        .footer-total { background-color: #90EE90; font-weight: bold; } /* Warna hijau muda */
        .header-group { background-color: #006400; color: white; }
    </style>
</head>
<body>

    <h1>Laporan Keuangan KOIN NU (Contoh 5 Bulan)</h1>

    <h2>MODUL 2: JURNAL UMUM (Bulan Januari - DANA MASUK 100%)</h2>
    <p>Penerimaan Dana KOIN NU diisi 100% dari total di Modul 1 (Rp 4.000.000).</p>
    <table id="tabel-modul-2">
        <thead>
            <tr>
                <th>NO</th>
                <th>TANGGAL</th>
                <th>KETERANGAN</th>
                <th>KATEGORI</th>
                <th>DANA MASUK</th>
                <th>DANA KELUAR</th>
                <th>SALDO</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>-</td>
                <td>01/01</td>
                <td>Saldo Bulan Lalu</td>
                <td>Saldo</td>
                <td class="text-right">0</td>
                <td class="text-right">0</td>
                <td id="m2-saldo-awal" class="text-right">0</td>
            </tr>
            <tr>
                <td>1</td>
                <td>31/01</td>
                <td style="font-weight: bold;">Penerimaan Dana KOIN NU (100% Total)</td>
                <td>Koin NU</td>
                <td id="m2-dana-masuk-koin" class="text-right" style="font-weight: bold;">0</td>
                <td class="text-right">0</td>
                <td id="m2-saldo-penerimaan" class="text-right">0</td>
            </tr>
            <tr>
                <td>2</td>
                <td>31/01</td>
                <td>Pengeluaran Honor Wajib (40%)</td>
                <td>Honor</td>
                <td class="text-right">0</td>
                <td id="m2-dana-keluar-honor" class="text-right">0</td>
                <td id="m2-saldo-honor" class="text-right">0</td>
            </tr>
            <tr>
                <td>3</td>
                <td>31/01</td>
                <td>Bantuan Sosial/Lain-lain</td>
                <td>Sosial</td>
                <td class="text-right">0</td>
                <td id="m2-dana-keluar-sosial" class="text-right">0</td>
                <td id="m2-saldo-akhir" class="text-right">0</td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="4" class="footer-total text-right">TOTAL</td>
                <td id="m2-total-masuk" class="footer-total text-right">0</td>
                <td id="m2-total-keluar" class="footer-total text-right">0</td>
                <td class="footer-total text-right">-</td>
            </tr>
        </tfoot>
    </table>

    <hr>

    <h2>MODUL 3: LAPORAN TAHUNAN (5 BULAN CONTOH)</h2>
    <table id="tabel-modul-3">
        <thead>
            <tr>
                <th rowspan="3">NO (1)</th>
                <th rowspan="3">BULAN</th>
                <th colspan="2" class="header-group">PENERIMAAN</th>
                <th colspan="7" class="header-group">PENGELUARAN WAJIB (5)</th>
                <th colspan="3" class="header-group">PENGELUARAN LAIN (6)</th>
                <th rowspan="3">JML PENGELUARAN (7)</th>
                <th rowspan="3">SALDO AKHIR BULAN INI (8)</th>
                <th rowspan="3">SALDO KAS TAHUN BERJALAN (9)</th>
            </tr>
            <tr>
                <th rowspan="2">Total Penerimaan Koin (3)</th>
                <th rowspan="2">Jml Donatur (4)</th>
                <th colspan="2">Pendidikan</th>
                <th colspan="2">Kesehatan</th>
                <th colspan="2">Ekonomi</th>
                <th rowspan="2">Honor Wajib (40%)</th>
                <th colspan="2">Biaya Lain</th>
                <th rowspan="2">PERW. & RAPAT</th>
            </tr>
            <tr>
                <th>Jml Uang</th>
                <th>Jml Penerima</th>
                <th>Jml Uang</th>
                <th>Jml Penerima</th>
                <th>Jml Uang</th>
                <th>Jml Penerima</th>
                <th>Rek Bank</th>
                <th>Lain</th>
            </tr>
        </thead>
        <tbody id="m3-data-body">
            </tbody>
        <tfoot>
            <tr>
                <td colspan="2" class="footer-total text-right">TOTAL TAHUNAN</td>
                <td class="footer-total text-right" id="m3-total-penerimaan">0</td>
                <td class="footer-total text-right" id="m3-total-donatur">0</td>
                <td class="footer-total text-right" id="m3-total-pend-uang">0</td>
                <td class="footer-total text-right" id="m3-total-pend-penerima">0</td>
                <td class="footer-total text-right" id="m3-total-kes-uang">0</td>
                <td class="footer-total text-right" id="m3-total-kes-penerima">0</td>
                <td class="footer-total text-right" id="m3-total-eko-uang">0</td>
                <td class="footer-total text-right" id="m3-total-eko-penerima">0</td>
                <td class="footer-total text-right" id="m3-total-honor">0</td>
                <td class="footer-total text-right">0</td>
                <td class="footer-total text-right">0</td>
                <td class="footer-total text-right">0</td>
                <td class="footer-total text-right" id="m3-total-pengeluaran">0</td>
                <td class="footer-total text-right" id="m3-footer-saldo-akhir">0</td>
                <td class="footer-total text-right" id="m3-footer-saldo-kas">0</td>
            </tr>
        </tfoot>
    </table>

    <script>
        // --- DATA SUMBER (5 BULAN) ---
        const LAPORAN_DATA = [
            { bulan: 'Januari', penerimaan: 4000000, donatur: 200, pendUang: 0, kesUang: 0, ekoUang: 0, sosialLain: 1000000, honorWajibPercent: 0.40 },
            { bulan: 'Februari', penerimaan: 5000000, donatur: 250, pendUang: 500000, kesUang: 0, ekoUang: 0, sosialLain: 0, honorWajibPercent: 0.40 },
            { bulan: 'Maret', penerimaan: 6000000, donatur: 300, pendUang: 500000, kesUang: 500000, ekoUang: 0, sosialLain: 500000, honorWajibPercent: 0.40 },
            { bulan: 'April', penerimaan: 3000000, donatur: 150, pendUang: 0, kesUang: 0, ekoUang: 0, sosialLain: 0, honorWajibPercent: 0.40 },
            { bulan: 'Mei', penerimaan: 7000000, donatur: 350, pendUang: 1000000, kesUang: 0, ekoUang: 0, sosialLain: 1000000, honorWajibPercent: 0.40 },
        ];

        // --- HELPER FUNCTION ---
        const formatNominal = (angka) => {
            if (typeof angka !== 'number' || isNaN(angka)) return '0';
            // Menampilkan minus jika angka negatif
            return angka.toLocaleString('id-ID', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        };

        // --- FUNGSI SINKRONISASI ---

        function updateJurnalUmum() {
            // Kita hanya fokus pada bulan Januari (data pertama)
            const dataJan = LAPORAN_DATA[0];
            const totalPenerimaan = dataJan.penerimaan; // 4.000.000
            const honorWajib = totalPenerimaan * dataJan.honorWajibPercent; // 1.600.000
            const pengeluaranSosial = dataJan.sosialLain; // 1.000.000

            // LOGIKA JURNAL UMUM (DANA MASUK 100% DAN PENGELUARAN 40% + SOSIAL)
            let saldoJurnalUmum = 0;
            let totalMasuk = 0;
            let totalKeluar = 0;

            // Baris 1: Saldo Awal
            document.getElementById('m2-saldo-awal').textContent = formatNominal(saldoJurnalUmum);

            // Baris 2: Penerimaan Dana KOIN NU (100%) - DISINKRONKAN
            saldoJurnalUmum += totalPenerimaan; // 0 + 4.000.000 = 4.000.000
            totalMasuk += totalPenerimaan;
            document.getElementById('m2-dana-masuk-koin').textContent = formatNominal(totalPenerimaan);
            document.getElementById('m2-saldo-penerimaan').textContent = formatNominal(saldoJurnalUmum);

            // Baris 3: Pengeluaran Honor Wajib (40%)
            saldoJurnalUmum -= honorWajib; // 4.000.000 - 1.600.000 = 2.400.000
            totalKeluar += honorWajib;
            document.getElementById('m2-dana-keluar-honor').textContent = formatNominal(honorWajib);
            document.getElementById('m2-saldo-honor').textContent = formatNominal(saldoJurnalUmum);
            
            // Baris 4: Bantuan Sosial/Lain-lain
            saldoJurnalUmum -= pengeluaranSosial; // 2.400.000 - 1.000.000 = 1.400.000
            totalKeluar += pengeluaranSosial;
            document.getElementById('m2-dana-keluar-sosial').textContent = formatNominal(pengeluaranSosial);
            document.getElementById('m2-saldo-akhir').textContent = formatNominal(saldoJurnalUmum);


            // FOOTER MODUL 2
            document.getElementById('m2-total-masuk').textContent = formatNominal(totalMasuk);
            document.getElementById('m2-total-keluar').textContent = formatNominal(totalKeluar);
        }

        function updateLaporanTahunan() {
            const tableBody = document.getElementById('m3-data-body');
            tableBody.innerHTML = ''; // Kosongkan data lama

            let totalPenerimaanTahunan = 0;
            let totalDonaturTahunan = 0;
            let totalPengeluaranTahunan = 0;
            let saldoKasTahunBerjalan = 0;

            LAPORAN_DATA.forEach((data, index) => {
                const no = index + 1;
                const honorWajib = data.penerimaan * data.honorWajibPercent;
                const jmlPengeluaranBulanIni = honorWajib + data.pendUang + data.kesUang + data.ekoUang + data.sosialLain;
                
                // Perhitungan Saldo
                const saldoAkhirBulanIni = data.penerimaan - jmlPengeluaranBulanIni;
                saldoKasTahunBerjalan += saldoAkhirBulanIni; // Akumulasi Saldo Kas

                // Akumulasi Total Tahunan
                totalPenerimaanTahunan += data.penerimaan;
                totalDonaturTahunan += data.donatur;
                totalPengeluaranTahunan += jmlPengeluaranBulanIni;
                
                // --- Buat Baris Data ---
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td>${no}</td>
                    <td>${data.bulan.toUpperCase()}</td>
                    <td class="text-right">${formatNominal(data.penerimaan)}</td>
                    <td class="text-right">${data.donatur}</td>
                    <td class="text-right">${formatNominal(data.pendUang)}</td>
                    <td class="text-right">0</td> <td class="text-right">${formatNominal(data.kesUang)}</td>
                    <td class="text-right">0</td> <td class="text-right">${formatNominal(data.ekoUang)}</td>
                    <td class="text-right">0</td> <td class="text-right">${formatNominal(honorWajib)}</td>
                    <td class="text-right">0</td>
                    <td class="text-right">0</td>
                    <td class="text-right">0</td>
                    <td class="text-right">${formatNominal(jmlPengeluaranBulanIni)}</td>
                    <td class="text-right">${formatNominal(saldoAkhirBulanIni)}</td>
                    <td class="text-right">${formatNominal(saldoKasTahunBerjalan)}</td>
                `;
            });

            // --- Update FOOTER (TOTAL TAHUNAN) ---
            document.getElementById('m3-total-penerimaan').textContent = formatNominal(totalPenerimaanTahunan);
            document.getElementById('m3-total-donatur').textContent = formatNominal(totalDonaturTahunan);
            document.getElementById('m3-total-pengeluaran').textContent = formatNominal(totalPengeluaranTahunan);
            
            // Kolom (8) dan (9) menggunakan nilai saldo akhir (bulan Mei)
            const saldoAkhirMei = saldoKasTahunBerjalan;
            document.getElementById('m3-footer-saldo-akhir').textContent = formatNominal(saldoAkhirMei);
            document.getElementById('m3-footer-saldo-kas').textContent = formatNominal(saldoAkhirMei);
        }

        // Jalankan fungsi setelah dokumen dimuat
        document.addEventListener('DOMContentLoaded', () => {
            updateJurnalUmum();
            updateLaporanTahunan();
        });
    </script>

</body>
</html>
